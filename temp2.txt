    def visitClassDefinition(self, ctx: ChronoParser.ClassDefinitionContext):
        class_name = ctx.name.text
        base_name = ctx.base.text

        self._in_class = True
        self._current_class_name = class_name
        self._class_sections = {"private": "", "public": ""}

        # 遍历 classBodyStatement 规则
        if hasattr(ctx, 'classBodyStatement'):
            for child in ctx.classBodyStatement():
                self.visit(child)  # <--- 这将调用 visitClassBodyStatement

        self._in_class = False
        self._current_class_name = None

        # [修复] 组装 C++ 类体 (移除了重复代码 )
        final_class_body = ""

        # 1. 输出 private (默认)
        if self._class_sections["private"]:
            final_class_body += "\nprivate:\n"
            final_class_body += self._class_sections["private"]

        # 2. 输出 public
        if self._class_sections["public"]:
            final_class_body += "\npublic:\n"
            final_class_body += self._class_sections["public"]

        return (
            f"\nclass {class_name} : public {base_name} {{\n"
            f"{final_class_body.strip()}\n"  # <-- 现在只包含正确的代码
            "};\n"
        )